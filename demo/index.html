<html>
	<head>
		<script type='text/javascript' src='../dist/lapidary.iife.js'></script>
		<link rel="stylesheet" href="./style.css" media="screen" />
	</head>
	<body>
		<script>
			var items = [
			  {
			    name: 'War and Peace',
			    edition: 2,
			    pagecount: 500,
			  },
			  {
			    name: 'Harry Potter and the Sorcerers Stone',
			    edition: 1,
			    pagecount: 300
			  },
			  {
			    name: 'Harry Potter and the Order of the Phoenix',
			    edition: 1,
			    pagecount: 560
			  },
			  {
			  	name: 'The Return of the King',
			  	edition: 2,
			  	pagecount: 446
			  },
			  {
			  	name: 'Herp a derp',
			  	edition: 1,
			  	pagecount: 320
			  },
			  {
			  	name: 'Herp a derp',
			  	edition: 2,
			  	pagecount: 320
			  }
			];
			var facets = {
			  name: {
			    operations: lapidary.StringOperations
			  },
			  edition: {
			  	operations: lapidary.NumericOperations
			  },
			  pagecount: {
			  	operations: lapidary.NumericOperations
			  },
			  is: {
			  	operations: lapidary.AbstractOperations
			  }
			};
			var defaultFacet = function(i, v) {
				return i.name.toLowerCase().indexOf(String(v).toLowerCase()) > -1
			}
			var l = new lapidary.Lapidary(items, facets, {}, defaultFacet);
			console.log(l);
			var handleInputChange = function() {
				var query = document.getElementById("lapidary-input").value;
				//console.log(query);
				var results = l.parseQuery(query);
				//var resultsArr = JSON.stringify(results);
				var outputDiv = document.getElementById("output");
				outputDiv.innerHTML = "";
				for (r of results) {
					var e = document.createElement('div');
					var name = document.createElement('div');
					name.innerHTML = "Name: " + r.name;
					e.appendChild(name);
					var edition = document.createElement('div');
					edition.innerHTML = "Edition: " + r.edition;
					e.appendChild(edition);
					var pagecount = document.createElement('div');
					pagecount.innerHTML = "Page Count: " + r.pagecount;
					e.appendChild(pagecount);

					outputDiv.appendChild(e);
				}

			}
			document.addEventListener('DOMContentLoaded', handleInputChange, false);
		</script>
		<input id="lapidary-input" onchange="handleInputChange()" type="text"/>
		<div id="output"></div>
	</body>
</html>